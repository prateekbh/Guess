/*
 Copyright 2016 Google Inc. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
(function(t,r){'object'==typeof exports&&'undefined'!=typeof module?module.exports=r():'function'==typeof define&&define.amd?define(r):(t.goog=t.goog||{},t.goog.swlib=r())})(this,function(){'use strict';function createCommonjsModule(te,ae){return ae={exports:{}},te(ae,ae.exports),ae.exports}function throwError(te){const ae=new Error(te),ne=l.parse(ae);throw 3<=ne.length&&(ae.message=`Invalid call to ${ne[2].functionName}() â€” `+te.replace(/\s+/g,' '),ae.name=ne[1].functionName.replace(/^Object\./,'')),ae}function parse(te,ae){for(var de,ne=[],se=0,ie=0,ce='',oe=ae&&ae.delimiter||'/';null!=(de=x.exec(te));){var le=de[0],pe=de[1],ue=de.index;if(ce+=te.slice(ie,ue),ie=ue+le.length,pe){ce+=pe[1];continue}var he=te[ie],me=de[2],ge=de[3],fe=de[4],ye=de[5],be=de[6],_e=de[7];ce&&(ne.push(ce),ce='');var Ce=de[2]||oe,xe=fe||ye;ne.push({name:ge||se++,prefix:me||'',delimiter:Ce,optional:'?'===be||'*'===be,repeat:'+'===be||'*'===be,partial:null!=me&&null!=he&&he!==me,asterisk:!!_e,pattern:xe?escapeGroup(xe):_e?'.*':'[^'+escapeString(Ce)+']+?'})}return ie<te.length&&(ce+=te.substr(ie)),ce&&ne.push(ce),ne}function encodeURIComponentPretty(te){return encodeURI(te).replace(/[\/?#]/g,function(ae){return'%'+ae.charCodeAt(0).toString(16).toUpperCase()})}function encodeAsterisk(te){return encodeURI(te).replace(/[?#]/g,function(ae){return'%'+ae.charCodeAt(0).toString(16).toUpperCase()})}function tokensToFunction(te){for(var ae=Array(te.length),ne=0;ne<te.length;ne++)'object'==typeof te[ne]&&(ae[ne]=new RegExp('^(?:'+te[ne].pattern+')$'));return function(se,ie){for(var ue,ce='',oe=se||{},de=ie||{},le=de.pretty?encodeURIComponentPretty:encodeURIComponent,pe=0;pe<te.length;pe++){if(ue=te[pe],'string'==typeof ue){ce+=ue;continue}var me,he=oe[ue.name];if(null==he)if(ue.optional){ue.partial&&(ce+=ue.prefix);continue}else throw new TypeError('Expected "'+ue.name+'" to be defined');if(y(he)){if(!ue.repeat)throw new TypeError('Expected "'+ue.name+'" to not repeat, but received `'+JSON.stringify(he)+'`');if(0===he.length)if(ue.optional)continue;else throw new TypeError('Expected "'+ue.name+'" to not be empty');for(var ge=0;ge<he.length;ge++){if(me=le(he[ge]),!ae[pe].test(me))throw new TypeError('Expected all "'+ue.name+'" to match "'+ue.pattern+'", but received `'+JSON.stringify(me)+'`');ce+=(0===ge?ue.prefix:ue.delimiter)+me}continue}if(me=ue.asterisk?encodeAsterisk(he):le(he),!ae[pe].test(me))throw new TypeError('Expected "'+ue.name+'" to match "'+ue.pattern+'", but received "'+me+'"');ce+=ue.prefix+me}return ce}}function escapeString(te){return te.replace(/([.+*?=^!:${}()[\]|\/\\])/g,'\\$1')}function escapeGroup(te){return te.replace(/([=!:$\/()])/g,'\\$1')}function attachKeys(te,ae){return te.keys=ae,te}function flags(te){return te.sensitive?'':'i'}function regexpToRegexp(te,ae){var ne=te.source.match(/\((?!\?)/g);if(ne)for(var se=0;se<ne.length;se++)ae.push({name:se,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return attachKeys(te,ae)}function arrayToRegexp(te,ae,ne){for(var se=[],ie=0;ie<te.length;ie++)se.push(pathToRegexp(te[ie],ae,ne).source);var ce=new RegExp('(?:'+se.join('|')+')',flags(ne));return attachKeys(ce,ae)}function stringToRegexp(te,ae,ne){return tokensToRegExp(parse(te,ne),ae,ne)}function tokensToRegExp(te,ae,ne){y(ae)||(ne=ae||ne,ae=[]),ne=ne||{};for(var de,se=ne.strict,ie=!1!==ne.end,ce='',oe=0;oe<te.length;oe++)if(de=te[oe],'string'==typeof de)ce+=escapeString(de);else{var le=escapeString(de.prefix),pe='(?:'+de.pattern+')';ae.push(de),de.repeat&&(pe+='(?:'+le+pe+')*'),pe=de.optional?de.partial?le+'('+pe+')?':'(?:'+le+'('+pe+'))?':le+'('+pe+')',ce+=pe}var ue=escapeString(ne.delimiter||'/'),he=ce.slice(-ue.length)===ue;return se||(ce=(he?ce.slice(0,-ue.length):ce)+'(?:'+ue+'(?=$))?'),ce+=ie?'$':se&&he?'':'(?='+ue+'|$)',attachKeys(new RegExp('^'+ce,flags(ne)),ae)}function pathToRegexp(te,ae,ne){return y(ae)||(ne=ae||ne,ae=[]),ne=ne||{},te instanceof RegExp?regexpToRegexp(te,ae):y(te)?arrayToRegexp(te,ae,ne):stringToRegexp(te,ae,ne)}function broadcastUpdate({channel:te,cacheName:ae,url:ne,source:se}){u.isInstance({channel:te},BroadcastChannel),u.isType({cacheName:ae},'string'),u.isType({source:se},'string'),u.isType({url:ne},'string'),te.postMessage({type:Z,meta:se,payload:{cacheName:ae,updatedUrl:ne}})}function responsesAreSame({first:te,second:ae,headersToCheck:ne}={}){if(!(te instanceof Response&&ae instanceof Response&&ne instanceof Array))throw z.createError('responses-are-same-parameters-required');return ne.every((se)=>{return te.headers.has(se)===ae.headers.has(se)&&te.headers.get(se)===ae.headers.get(se)})}class ErrorFactory$1{constructor(te){this._errors=te}createError(te,ae){if(!(te in this._errors))throw new Error(`Unable to generate error '${te}'.`);let ne=this._errors[te].replace(/\s+/g,' '),se=null;ae&&(ne+=` [${ae.message}]`,se=ae.stack);const ie=new Error;return ie.name=te,ie.message=ne,ie.stack=se,ie}}const t={'not-in-sw':'sw-lib must be loaded in your service worker file.','unsupported-route-type':'Routes must be either a express style route string, a Regex to capture request URLs or a Route instance.','empty-express-string':'The Express style route string must have some characters, an empty string is invalid.','bad-revisioned-cache-list':`The 'cacheRevisionedAssets()' method expects`+`an array of revisioned urls like so: ['/example/hello.1234.txt', `+`{path: 'hello.txt', revision: '1234'}]`};var r=new ErrorFactory$1(t);const a={'express-route-requires-absolute-path':`When using ExpressRoute, you must
    provide a path that starts with a '/' character. You can only match
    same-origin requests. For more flexibility, use RegExpRoute.`};var s=new ErrorFactory$1(a),o='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,d=createCommonjsModule(function(te){(function(ne,se){'use strict';te.exports=se()})(o,function(){'use strict';function _isNumber(pe){return!isNaN(parseFloat(pe))&&isFinite(pe)}function _capitalize(pe){return pe[0].toUpperCase()+pe.substring(1)}function _getter(pe){return function(){return this[pe]}}function StackFrame(pe){if(pe instanceof Object)for(var ue=ne.concat(se.concat(ie.concat(ce))),he=0;he<ue.length;he++)pe.hasOwnProperty(ue[he])&&void 0!==pe[ue[he]]&&this['set'+_capitalize(ue[he])](pe[ue[he]])}var ne=['isConstructor','isEval','isNative','isToplevel'],se=['columnNumber','lineNumber'],ie=['fileName','functionName','source'],ce=['args'];StackFrame.prototype={getArgs:function(){return this.args},setArgs:function(pe){if('[object Array]'!==Object.prototype.toString.call(pe))throw new TypeError('Args must be an Array');this.args=pe},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(pe){if(pe instanceof StackFrame)this.evalOrigin=pe;else if(pe instanceof Object)this.evalOrigin=new StackFrame(pe);else throw new TypeError('Eval Origin must be an Object or StackFrame')},toString:function(){var pe=this.getFunctionName()||'{anonymous}',ue='('+(this.getArgs()||[]).join(',')+')',he=this.getFileName()?'@'+this.getFileName():'',me=_isNumber(this.getLineNumber())?':'+this.getLineNumber():'',ge=_isNumber(this.getColumnNumber())?':'+this.getColumnNumber():'';return pe+ue+he+me+ge}};for(var oe=0;oe<ne.length;oe++)StackFrame.prototype['get'+_capitalize(ne[oe])]=_getter(ne[oe]),StackFrame.prototype['set'+_capitalize(ne[oe])]=function(pe){return function(ue){this[pe]=!!ue}}(ne[oe]);for(var de=0;de<se.length;de++)StackFrame.prototype['get'+_capitalize(se[de])]=_getter(se[de]),StackFrame.prototype['set'+_capitalize(se[de])]=function(pe){return function(ue){if(!_isNumber(ue))throw new TypeError(pe+' must be a Number');this[pe]=+ue}}(se[de]);for(var le=0;le<ie.length;le++)StackFrame.prototype['get'+_capitalize(ie[le])]=_getter(ie[le]),StackFrame.prototype['set'+_capitalize(ie[le])]=function(pe){return function(ue){this[pe]=ue+''}}(ie[le]);return StackFrame})}),l=createCommonjsModule(function(te){(function(ne,se){'use strict';te.exports=se(d)})(o,function ErrorStackParser(ne){'use strict';var se=/(^|@)\S+\:\d+/,ie=/^\s*at .*(\S+\:\d+|\(native\))/m,ce=/^(eval@)?(\[native code\])?$/;return{parse:function ErrorStackParser$$parse(oe){if('undefined'!=typeof oe.stacktrace||'undefined'!=typeof oe['opera#sourceloc'])return this.parseOpera(oe);if(oe.stack&&oe.stack.match(ie))return this.parseV8OrIE(oe);if(oe.stack)return this.parseFFOrSafari(oe);throw new Error('Cannot parse given Error object')},extractLocation:function ErrorStackParser$$extractLocation(oe){if(-1===oe.indexOf(':'))return[oe];var de=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,le=de.exec(oe.replace(/[\(\)]/g,''));return[le[1],le[2]||void 0,le[3]||void 0]},parseV8OrIE:function ErrorStackParser$$parseV8OrIE(oe){var de=oe.stack.split('\n').filter(function(le){return!!le.match(ie)},this);return de.map(function(le){-1<le.indexOf('(eval ')&&(le=le.replace(/eval code/g,'eval').replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,''));var pe=le.replace(/^\s+/,'').replace(/\(eval code/g,'(').split(/\s+/).slice(1),ue=this.extractLocation(pe.pop()),he=pe.join(' ')||void 0,me=-1<['eval','<anonymous>'].indexOf(ue[0])?void 0:ue[0];return new ne({functionName:he,fileName:me,lineNumber:ue[1],columnNumber:ue[2],source:le})},this)},parseFFOrSafari:function ErrorStackParser$$parseFFOrSafari(oe){var de=oe.stack.split('\n').filter(function(le){return!le.match(ce)},this);return de.map(function(le){if(-1<le.indexOf(' > eval')&&(le=le.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,':$1')),-1===le.indexOf('@')&&-1===le.indexOf(':'))return new ne({functionName:le});var pe=le.split('@'),ue=this.extractLocation(pe.pop()),he=pe.join('@')||void 0;return new ne({functionName:he,fileName:ue[0],lineNumber:ue[1],columnNumber:ue[2],source:le})},this)},parseOpera:function ErrorStackParser$$parseOpera(oe){return!oe.stacktrace||-1<oe.message.indexOf('\n')&&oe.message.split('\n').length>oe.stacktrace.split('\n').length?this.parseOpera9(oe):oe.stack?this.parseOpera11(oe):this.parseOpera10(oe)},parseOpera9:function ErrorStackParser$$parseOpera9(oe){for(var me,de=/Line (\d+).*script (?:in )?(\S+)/i,le=oe.message.split('\n'),pe=[],ue=2,he=le.length;ue<he;ue+=2)me=de.exec(le[ue]),me&&pe.push(new ne({fileName:me[2],lineNumber:me[1],source:le[ue]}));return pe},parseOpera10:function ErrorStackParser$$parseOpera10(oe){for(var me,de=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,le=oe.stacktrace.split('\n'),pe=[],ue=0,he=le.length;ue<he;ue+=2)me=de.exec(le[ue]),me&&pe.push(new ne({functionName:me[3]||void 0,fileName:me[2],lineNumber:me[1],source:le[ue]}));return pe},parseOpera11:function ErrorStackParser$$parseOpera11(oe){var de=oe.stack.split('\n').filter(function(le){return!!le.match(se)&&!le.match(/^Error created at/)},this);return de.map(function(le){var pe=le.split('@'),ue=this.extractLocation(pe.pop()),he=pe.shift()||'',me=he.replace(/<anonymous function(: (\w+))?>/,'$2').replace(/\([^\)]*\)/g,'')||void 0,ge;he.match(/\(([^\)]*)\)/)&&(ge=he.replace(/^[^\(]+\(([^\)]*)\)$/,'$1'));var fe=ge===void 0||'[arguments not available]'===ge?void 0:ge.split(',');return new ne({functionName:me,args:fe,fileName:ue[0],lineNumber:ue[1],columnNumber:ue[2],source:le})},this)}}})}),u={atLeastOne:function atLeastOne(te){const ae=Object.keys(te);ae.some((ne)=>te[ne]!==void 0)||throwError('Please set at least one of the following parameters: '+ae.map((ne)=>`'${ne}'`).join(', '))},hasMethod:function hasMethod(te,ae){const ne=Object.keys(te).pop(),se=typeof te[ne][ae];'function'!=se&&throwError(`The '${ne}' parameter must be an object that exposes a
      '${ae}' method.`)},isInstance:function isInstance(te,ae){const ne=Object.keys(te).pop();te[ne]instanceof ae||throwError(`The '${ne}' parameter must be an instance of
      '${ae.name}'`)},isOneOf:function isOneOf(te,ae){const ne=Object.keys(te).pop();ae.includes(te[ne])||throwError(`The '${ne}' parameter must be set to one of the
      following: ${ae}`)},isType:function isType(te,ae){const ne=Object.keys(te).pop(),se=typeof te[ne];se!==ae&&throwError(`The '${ne}' parameter has the wrong type. (Expected:
      ${ae}, actual: ${se})`)},isSWEnv:function isSWEnv(){return'ServiceWorkerGlobalScope'in self&&self instanceof ServiceWorkerGlobalScope},isValue:function isValue(te,ae){const ne=Object.keys(te).pop(),se=te[ne];se!==ae&&throwError(`The '${ne}' parameter has the wrong value. (Expected:
      ${ae}, actual: ${se})`)},isArrayOfType:function isArrayOfType(te,ae){const ne=Object.keys(te).pop(),se=`The '${ne}' parameter should be an array containing
    one or more '${ae}' elements.`;Array.isArray(te[ne])||throwError(se);for(let ie of te[ne])typeof ie!==ae&&throwError(se)},isArrayOfClass:function isArrayOfClass(te,ae){const ne=Object.keys(te).pop(),se=`The '${ne}' parameter should be an array containing
    one or more '${ae.name}' instances.`;Array.isArray(te[ne])||throwError(se);for(let ie of te[ne])ie instanceof ae||throwError(se)}};const g=['DELETE','GET','HEAD','POST','PUT'];class Route{constructor({match:te,handler:ae,method:ne}={}){u.isType({match:te},'function'),u.isType({handler:ae},'object'),u.hasMethod({handler:ae},'handle'),this.match=te,this.handler=ae,ne?(u.isOneOf({method:ne},g),this.method=ne):this.method='GET'}}var f=Array.isArray||function(te){return'[object Array]'==Object.prototype.toString.call(te)},y=f,b=pathToRegexp,x=new RegExp(['(\\\\.)','([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))'].join('|'),'g');b.parse=parse,b.compile=function compile(te,ae){return tokensToFunction(parse(te,ae))},b.tokensToFunction=tokensToFunction,b.tokensToRegExp=tokensToRegExp;class ExpressRoute extends Route{constructor({path:te,handler:ae,method:ne}){if('/'!==te.substring(0,1))throw s.createError('express-route-requires-absolute-path');let se=[];const ie=b(te,se);super({match:({url:oe})=>{if(oe.origin!==location.origin)return null;const de=oe.pathname.match(ie);if(!de)return null;const le={};return se.forEach((pe,ue)=>{le[pe.name]=de[ue+1]}),le},handler:ae,method:ne})}}class RegExpRoute extends Route{constructor({regExp:te,handler:ae,method:ne}){u.isInstance({regExp:te},RegExp);super({match:({url:ie})=>{const ce=ie.href.match(te);return ce?ce.slice(1):null},handler:ae,method:ne})}}class Router$2{setDefaultHandler({handler:te}={}){u.hasMethod({handler:te},'handle'),this.defaultHandler=te}setCatchHandler({handler:te}={}){u.hasMethod({handler:te},'handle'),this.catchHandler=te}registerRoutes({routes:te}={}){u.isArrayOfClass({routes:te},Route),self.addEventListener('fetch',(ae)=>{const ne=new URL(ae.request.url);if(ne.protocol.startsWith('http')){let se;for(let ie of te||[])if(ie.method===ae.request.method){const ce=ie.match({url:ne,event:ae});if(ce){let oe=ce;Array.isArray(oe)&&0===oe.length?oe=void 0:oe.constructor===Object&&0===Object.keys(oe).length&&(oe=void 0),se=ie.handler.handle({url:ne,event:ae,params:oe});break}}!se&&this.defaultHandler&&(se=this.defaultHandler.handle({url:ne,event:ae})),se&&this.catchHandler&&(se=se.catch((ie)=>{return this.catchHandler.handle({url:ne,event:ae,error:ie})})),se&&ae.respondWith(se)}})}registerRoute({route:te}={}){u.isInstance({route:te},Route),this.registerRoutes({routes:[te]})}}class Router$$1{constructor(){this._router=new Router$2}registerRoute(te,ae){if('function'==typeof ae&&(ae={handle:ae}),'string'==typeof te){if(0===te.length)throw r.createError('empty-express-string');this._router.registerRoute({route:new ExpressRoute({path:te,handler:ae})})}else if(te instanceof RegExp)this._router.registerRoute({route:new RegExpRoute({regExp:te,handler:ae})});else if(te instanceof Route)this._router.registerRoute({route:te});else throw r.createError('unsupported-route-type')}}const q={'not-in-sw':'sw-precaching must be loaded in your service worker file.','invalid-revisioned-entry':`File manifest entries must be either a `+`string with revision info in the url or an object with a 'url' and `+`'revision' parameters.`,'invalid-unrevisioned-entry':``,'bad-cache-bust':`The cache bust parameter must be a boolean.`,'duplicate-entry-diff-revisions':`An attempt was made to cache the same `+`url twice with each having different revisions. This is not supported.`,'request-not-cached':`A request failed the criteria to be cached. By `+`default, only responses with 'response.ok = true' are cached.`,'should-override':'Method should be overridden by the extending class.'};var O=new ErrorFactory$1(q);let T=`sw-runtime-caching`;self&&self.registration&&(T+=`-${self.registration.scope}`);const w=T,I=['cacheDidUpdate','cacheWillMatch','cacheWillUpdate','fetchDidFail','requestWillFetch'];var S=new ErrorFactory$1({'multiple-cache-will-update-plugins':'You cannot register more than one plugin that implements cacheWillUpdate.','multiple-cache-will-match-plugins':'You cannot register more than one plugin that implements cacheWillMatch.','invalid-reponse-for-caching':'The fetched response could not be cached due to an invalid response code, by default only 20X responses can be cached.'}),D=function(te){return function(){var ae=te.apply(this,arguments);return new Promise(function(ne,se){function step(ie,ce){try{var oe=ae[ie](ce),de=oe.value}catch(le){return void se(le)}return oe.done?void ne(de):Promise.resolve(de).then(function(le){step('next',le)},function(le){step('throw',le)})}return step('next')})}};class RequestWrapper{constructor({cacheName:te,plugins:ae,fetchOptions:ne,matchOptions:se}={}){if(te?(u.isType({cacheName:te},'string'),this.cacheName=te):this.cacheName=w,ne&&(u.isType({fetchOptions:ne},'object'),this.fetchOptions=ne),se&&(u.isType({matchOptions:se},'object'),this.matchOptions=se),this.pluginCallbacks={},ae&&(u.isArrayOfType({plugins:ae},'object'),ae.forEach((ie)=>{for(let ce of I)'function'==typeof ie[ce]&&(this.pluginCallbacks[ce]||(this.pluginCallbacks[ce]=[]),this.pluginCallbacks[ce].push(ie[ce].bind(ie)))})),this.pluginCallbacks.cacheWillUpdate&&1!==this.pluginCallbacks.cacheWillUpdate.length)throw S.createError('multiple-cache-will-update-plugins');if(this.pluginCallbacks.cacheWillMatch&&1!==this.pluginCallbacks.cacheWillMatch.length)throw S.createError('multiple-cache-will-match-plugins')}getCache(){var te=this;return D(function*(){return te._cache||(te._cache=yield caches.open(te.cacheName)),te._cache})()}match({request:te}){var ae=this;return D(function*(){u.atLeastOne({request:te});const ne=yield ae.getCache();let se=yield ne.match(te,ae.matchOptions);return ae.pluginCallbacks.cacheWillMatch&&(se=ae.pluginCallbacks.cacheWillMatch[0]({cachedResponse:se})),se})()}fetch({request:te}){var ae=this;return D(function*(){if(u.atLeastOne({request:te}),ae.pluginCallbacks.requestWillFetch)for(let ne of ae.pluginCallbacks.requestWillFetch){const se=ne({request:te});u.isInstance({returnedPromise:se},Promise);const ie=yield se;u.isInstance({returnedRequest:ie},Request),te=ie}try{return yield fetch(te,ae.fetchOptions)}catch(ne){if(ae.pluginCallbacks.fetchDidFail)for(let se of ae.pluginCallbacks.fetchDidFail)se({request:te});throw ne}})()}fetchAndCache({request:te,waitOnCache:ae,cacheKey:ne}){var se=this;return D(function*(){u.atLeastOne({request:te});let ie;const ce=yield se.fetch({request:te});let oe=ce.ok;if(se.pluginCallbacks.cacheWillUpdate&&(oe=se.pluginCallbacks.cacheWillUpdate[0]({request:te,response:ce})),oe){const de=ce.clone();ie=se.getCache().then((()=>{var le=D(function*(pe){let ue;'opaque'!==ce.type&&se.pluginCallbacks.cacheDidUpdate&&(ue=yield se.match({request:te}));yield pe.put(ne||te,de);for(let me of se.pluginCallbacks.cacheDidUpdate||[])me({cacheName:se.cacheName,oldResponse:ue,newResponse:de})});return function(){return le.apply(this,arguments)}})())}else if(!oe&&ae)throw S.createError('invalid-reponse-for-caching');return ae&&ie&&(yield ie),ce})()}}class Handler{constructor({requestWrapper:te}={}){this.requestWrapper=te?te:new RequestWrapper}handle({event:te,params:ae}={}){throw Error('This abstract method must be implemented in a subclass.')}}class CacheFirst extends Handler{handle({event:te}={}){var ae=this;return D(function*(){u.isInstance({event:te},FetchEvent);const ne=yield ae.requestWrapper.match({request:te.request});return ne||(yield ae.requestWrapper.fetchAndCache({request:te.request}))})()}}class CacheOnly extends Handler{handle({event:te}={}){var ae=this;return D(function*(){return u.isInstance({event:te},FetchEvent),yield ae.requestWrapper.match({request:te.request})})()}}class NetworkFirst extends Handler{handle({event:te}={}){var ae=this;return D(function*(){u.isInstance({event:te},FetchEvent);let ne;try{if(ne=yield ae.requestWrapper.fetchAndCache({request:te.request}),ne)return ne}catch(se){}return yield ae.requestWrapper.match({request:te.request})})()}}class NetworkOnly extends Handler{handle({event:te}={}){var ae=this;return D(function*(){return u.isInstance({event:te},FetchEvent),yield ae.requestWrapper.fetch({request:te.request})})()}}class StaleWhileRevalidate extends Handler{handle({event:te}={}){var ae=this;return D(function*(){u.isInstance({event:te},FetchEvent);const ne=ae.requestWrapper.fetchAndCache({request:te.request}).catch(function(){return Response.error()}),se=yield ae.requestWrapper.match({request:te.request});return se||(yield ne)})()}}class BaseCacheManager{constructor(te){this._entriesToCache=new Map,this._requestWrapper=new RequestWrapper({cacheName:te,fetchOptions:{credentials:'same-origin'}}),this._cacheName=this._requestWrapper.cacheName}_addEntries(te){this._parsedCacheUrls=null,te.forEach((ae)=>{this._addEntryToInstallList(this._parseEntry(ae))})}getCacheName(){return this._cacheName}getCachedUrls(){return this._parsedCacheUrls||(this._parsedCacheUrls=Array.from(this._entriesToCache.keys()).map((te)=>new URL(te,location).href)),this._parsedCacheUrls}_addEntryToInstallList(te){const ae=te.entryID,ne=this._entriesToCache.get(te.entryID);return ne?void this._onDuplicateInstallEntryFound(te,ne):void this._entriesToCache.set(ae,te)}install(){var te=this;return D(function*(){if(0!==te._entriesToCache.size){const ae=[];return te._entriesToCache.forEach(function(ne){ae.push(te._cacheEntry(ne))}),Promise.all(ae)}})()}_cacheEntry(te){var ae=this;return D(function*(){const ne=yield ae._isAlreadyCached(te);if(!ne)try{return yield ae._requestWrapper.fetchAndCache({request:te.getNetworkRequest(),waitOnCache:!0,cacheKey:te.request}),ae._onEntryCached(te)}catch(se){throw O.createError('request-not-cached',{message:`Failed to get a cacheable response for `+`'${te.request.url}': ${se.message}`})}})()}cleanup(){var te=this;return D(function*(){if(yield caches.has(te._cacheName)){const ae=[];te._entriesToCache.forEach(function(ce){ae.push(ce.request.url)});const ne=yield te._getCache(),se=yield ne.keys(),ie=se.filter(function(ce){return!ae.includes(ce.url)});return Promise.all(ie.map(function(ce){return ne.delete(ce)}))}})()}_getCache(){var te=this;return D(function*(){return te._cache||(te._cache=yield caches.open(te._cacheName)),te._cache})()}_parseEntry(){throw O.createError('should-override')}_onDuplicateEntryFound(){throw O.createError('should-override')}_isAlreadyCached(){throw O.createError('should-override')}_onEntryCached(){throw O.createError('should-override')}}var W=createCommonjsModule(function(te){'use strict';(function(){function toArray(ne){return Array.prototype.slice.call(ne)}function promisifyRequest(ne){return new Promise(function(se,ie){ne.onsuccess=function(){se(ne.result)},ne.onerror=function(){ie(ne.error)}})}function promisifyRequestCall(ne,se,ie){var ce,oe=new Promise(function(de,le){ce=ne[se].apply(ne,ie),promisifyRequest(ce).then(de,le)});return oe.request=ce,oe}function promisifyCursorRequestCall(ne,se,ie){var ce=promisifyRequestCall(ne,se,ie);return ce.then(function(oe){return oe?new Cursor(oe,ce.request):void 0})}function proxyProperties(ne,se,ie){ie.forEach(function(ce){Object.defineProperty(ne.prototype,ce,{get:function(){return this[se][ce]},set:function(oe){this[se][ce]=oe}})})}function proxyRequestMethods(ne,se,ie,ce){ce.forEach(function(oe){oe in ie.prototype&&(ne.prototype[oe]=function(){return promisifyRequestCall(this[se],oe,arguments)})})}function proxyMethods(ne,se,ie,ce){ce.forEach(function(oe){oe in ie.prototype&&(ne.prototype[oe]=function(){return this[se][oe].apply(this[se],arguments)})})}function proxyCursorRequestMethods(ne,se,ie,ce){ce.forEach(function(oe){oe in ie.prototype&&(ne.prototype[oe]=function(){return promisifyCursorRequestCall(this[se],oe,arguments)})})}function Index(ne){this._index=ne}function Cursor(ne,se){this._cursor=ne,this._request=se}function ObjectStore(ne){this._store=ne}function Transaction(ne){this._tx=ne,this.complete=new Promise(function(se,ie){ne.oncomplete=function(){se()},ne.onerror=function(){ie(ne.error)},ne.onabort=function(){ie(ne.error)}})}function UpgradeDB(ne,se,ie){this._db=ne,this.oldVersion=se,this.transaction=new Transaction(ie)}function DB(ne){this._db=ne}proxyProperties(Index,'_index',['name','keyPath','multiEntry','unique']),proxyRequestMethods(Index,'_index',IDBIndex,['get','getKey','getAll','getAllKeys','count']),proxyCursorRequestMethods(Index,'_index',IDBIndex,['openCursor','openKeyCursor']),proxyProperties(Cursor,'_cursor',['direction','key','primaryKey','value']),proxyRequestMethods(Cursor,'_cursor',IDBCursor,['update','delete']),['advance','continue','continuePrimaryKey'].forEach(function(ne){ne in IDBCursor.prototype&&(Cursor.prototype[ne]=function(){var se=this,ie=arguments;return Promise.resolve().then(function(){return se._cursor[ne].apply(se._cursor,ie),promisifyRequest(se._request).then(function(ce){return ce?new Cursor(ce,se._request):void 0})})})}),ObjectStore.prototype.createIndex=function(){return new Index(this._store.createIndex.apply(this._store,arguments))},ObjectStore.prototype.index=function(){return new Index(this._store.index.apply(this._store,arguments))},proxyProperties(ObjectStore,'_store',['name','keyPath','indexNames','autoIncrement']),proxyRequestMethods(ObjectStore,'_store',IDBObjectStore,['put','add','delete','clear','get','getAll','getKey','getAllKeys','count']),proxyCursorRequestMethods(ObjectStore,'_store',IDBObjectStore,['openCursor','openKeyCursor']),proxyMethods(ObjectStore,'_store',IDBObjectStore,['deleteIndex']),Transaction.prototype.objectStore=function(){return new ObjectStore(this._tx.objectStore.apply(this._tx,arguments))},proxyProperties(Transaction,'_tx',['objectStoreNames','mode']),proxyMethods(Transaction,'_tx',IDBTransaction,['abort']),UpgradeDB.prototype.createObjectStore=function(){return new ObjectStore(this._db.createObjectStore.apply(this._db,arguments))},proxyProperties(UpgradeDB,'_db',['name','version','objectStoreNames']),proxyMethods(UpgradeDB,'_db',IDBDatabase,['deleteObjectStore','close']),DB.prototype.transaction=function(){return new Transaction(this._db.transaction.apply(this._db,arguments))},proxyProperties(DB,'_db',['name','version','objectStoreNames']),proxyMethods(DB,'_db',IDBDatabase,['close']),['openCursor','openKeyCursor'].forEach(function(ne){[ObjectStore,Index].forEach(function(se){se.prototype[ne.replace('open','iterate')]=function(){var ie=toArray(arguments),ce=ie[ie.length-1],oe=this._store||this._index,de=oe[ne].apply(oe,ie.slice(0,-1));de.onsuccess=function(){ce(de.result)}}})}),[Index,ObjectStore].forEach(function(ne){ne.prototype.getAll||(ne.prototype.getAll=function(se,ie){var ce=this,oe=[];return new Promise(function(de){ce.iterateCursor(se,function(le){return le?(oe.push(le.value),void 0!==ie&&oe.length==ie?void de(oe):void le.continue()):void de(oe)})})})});te.exports={open:function(ne,se,ie){var ce=promisifyRequestCall(indexedDB,'open',[ne,se]),oe=ce.request;return oe.onupgradeneeded=function(de){ie&&ie(new UpgradeDB(oe.result,de.oldVersion,oe.transaction))},ce.then(function(de){return new DB(de)})},delete:function(ne){return promisifyRequestCall(indexedDB,'deleteDatabase',[ne])}}})()});class IDBHelper{constructor(te,ae,ne){if(te==void 0||ae==void 0||ne==void 0)throw Error('name, version, storeName must be passed to the constructor.');this._name=te,this._version=ae,this._storeName=ne}_getDb(){return this._dbPromise?this._dbPromise:(this._dbPromise=W.open(this._name,this._version,(te)=>{te.createObjectStore(this._storeName)}).then((te)=>{return te}),this._dbPromise)}close(){return this._dbPromise?this._dbPromise.then((te)=>{te.close(),this._dbPromise=null}):void 0}put(te,ae){return this._getDb().then((ne)=>{const se=ne.transaction(this._storeName,'readwrite'),ie=se.objectStore(this._storeName);return ie.put(ae,te),se.complete})}delete(te){return this._getDb().then((ae)=>{const ne=ae.transaction(this._storeName,'readwrite'),se=ne.objectStore(this._storeName);return se.delete(te),ne.complete})}get(te){return this._getDb().then((ae)=>{return ae.transaction(this._storeName).objectStore(this._storeName).get(te)})}getAllValues(){return this._getDb().then((te)=>{return te.transaction(this._storeName).objectStore(this._storeName).getAll()})}getAllKeys(){return this._getDb().then((te)=>{return te.transaction(this._storeName).objectStore(this._storeName).getAllKeys()})}}let L=`sw-precaching-revisioned-${'v1'}`;self&&self.registration&&(L+=`-${self.registration.scope}`);const B=L;class RevisionDetailsModel{constructor(){this._idbHelper=new IDBHelper('sw-precaching','1','asset-revisions')}get(te){return this._idbHelper.get(te)}put(te,ae){return this._idbHelper.put(te,ae)}_close(){this._idbHelper.close()}}class BaseCacheEntry{constructor({entryID:te,revision:ae,request:ne,cacheBust:se}){this.entryID=te,this.revision=ae,this.request=ne,this.cacheBust=se}getNetworkRequest(){if(!0!==this.cacheBust)return this.request;let te=this.request.url;const ae={};if(!0===this.cacheBust)if('cache'in Request.prototype)ae.cache='reload';else{const ne=new URL(te,location);ne.search+=(ne.search?'&':'')+encodeURIComponent('_sw-precaching')+'='+encodeURIComponent(this.revision),te=ne.toString()}return new Request(te,ae)}}class StringCacheEntry extends BaseCacheEntry{constructor(te){if(u.isType({url:te},'string'),0===te.length)throw O.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(te)));super({entryID:te,revision:te,request:new Request(te),cacheBust:!1})}}class DefaultsCacheEntry extends BaseCacheEntry{constructor({entryID:te,revision:ae,url:ne,cacheBust:se}){if('undefined'==typeof se&&(se=!0),'undefined'==typeof te&&(te=new URL(ne,location).toString()),u.isType({revision:ae},'string'),0===ae.length)throw O.createError('invalid-revisioned-entry',new Error('Bad revision Parameter. It should be a string with at least one character: '+JSON.stringify(ae)));if(u.isType({url:ne},'string'),0===ne.length)throw O.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(ne)));if(u.isType({entryID:te},'string'),0===te.length)throw O.createError('invalid-revisioned-entry',new Error('Bad entryID Parameter. It should be a string with at least one character: '+JSON.stringify(te)));u.isType({cacheBust:se},'boolean'),super({entryID:te,revision:ae,request:new Request(ne),cacheBust:se})}}class RevisionedCacheManager extends BaseCacheManager{constructor({cacheName:te}={}){te=te||B,super(te),this._revisionDetailsModel=new RevisionDetailsModel}addToCacheList({revisionedFiles:te}={}){u.isInstance({revisionedFiles:te},Array),super._addEntries(te)}_parseEntry(te){if('undefined'==typeof te||null===te)throw O.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(te)));let ae;switch(typeof te){case'string':ae=new StringCacheEntry(te);break;case'object':ae=new DefaultsCacheEntry(te);break;default:throw O.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ae)));}return ae}_onDuplicateInstallEntryFound(te,ae){if(ae.revision!==te.revision)throw O.createError('duplicate-entry-diff-revisions',new Error(`${JSON.stringify(ae)} <=> `+`${JSON.stringify(te)}`))}_isAlreadyCached(te){var ae=this;return D(function*(){const ne=yield ae._revisionDetailsModel.get(te.entryID);if(ne!==te.revision)return!1;const se=yield ae._getCache(),ie=yield se.match(te.request);return!!ie})()}_onEntryCached(te){var ae=this;return D(function*(){yield ae._revisionDetailsModel.put(te.entryID,te.revision)})()}_close(){this._revisionDetailsModel._close()}cleanup(){return super.cleanup().then(()=>{return this._close()})}}class RequestCacheEntry extends BaseCacheEntry{constructor(te){if(!(te instanceof Request))throw O.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(te)));super({entryID:te.url,request:te,cacheBust:!1})}}class UnrevisionedCacheManager extends BaseCacheManager{constructor({cacheName:te}={}){super(te)}addToCacheList({unrevisionedFiles:te}={}){u.isInstance({unrevisionedFiles:te},Array),super._addEntries(te)}_parseEntry(te){if('undefined'==typeof te||null===te)throw O.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(te)));if('string'==typeof te)return new StringCacheEntry(te);if(te instanceof Request)return new RequestCacheEntry(te);throw O.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(te)))}_onDuplicateInstallEntryFound(){}_isAlreadyCached(){return D(function*(){return!1})()}_onEntryCached(){}}if(!u.isSWEnv())throw O.createError('not-in-sw');const K=`sw-cache-expiration-${self.registration.scope}`,$='url',V='timestamp',G={'max-entries-or-age-required':`Either the maxEntries or maxAgeSeconds
    parameters (or both) are required when constructing Plugin.`,'max-entries-must-be-number':`The maxEntries parameter to the Plugin
    constructor must either be a number or undefined.`,'max-age-seconds-must-be-number':`The maxAgeSeconds parameter to the Plugin
    constructor must either be a number or undefined.`};var Y=new ErrorFactory$1(G);class Plugin{constructor({maxEntries:te,maxAgeSeconds:ae}={}){if(!(te||ae))throw Y.createError('max-entries-or-age-required');if(te&&'number'!=typeof te)throw Y.createError('max-entries-must-be-number');if(ae&&'number'!=typeof ae)throw Y.createError('max-age-seconds-must-be-number');this.maxEntries=te,this.maxAgeSeconds=ae,this._dbs=new Map,this._caches=new Map}getDB({cacheName:te}={}){var ae=this;return D(function*(){u.isType({cacheName:te},'string');const ne=`${K}-${te}`;if(!ae._dbs.has(ne)){const se=yield W.open(ne,1,function(ie){const ce=ie.createObjectStore(te,{keyPath:$});ce.createIndex(V,V,{unique:!1})});ae._dbs.set(ne,se)}return ae._dbs.get(ne)})()}getCache({cacheName:te}={}){var ae=this;return D(function*(){if(u.isType({cacheName:te},'string'),!ae._caches.has(te)){const ne=yield caches.open(te);ae._caches.set(te,ne)}return ae._caches.get(te)})()}cacheWillMatch({cachedResponse:te,now:ae}={}){return this.isResponseFresh({cachedResponse:te,now:ae})?te:null}isResponseFresh({cachedResponse:te,now:ae}={}){if(te&&this.maxAgeSeconds){u.isInstance({cachedResponse:te},Response);const ne=te.headers.get('date');if(ne){'undefined'==typeof ae&&(ae=Date.now());const se=new Date(ne);if(se.getTime()+1e3*this.maxAgeSeconds<ae)return!1}}return!0}cacheDidUpdate({cacheName:te,newResponse:ae,now:ne}={}){u.isType({cacheName:te},'string'),u.isInstance({newResponse:ae},Response),'undefined'==typeof ne&&(ne=Date.now()),this.updateTimestamp({cacheName:te,now:ne,url:ae.url}).then(()=>{this.expireEntries({cacheName:te,now:ne})})}updateTimestamp({cacheName:te,url:ae,now:ne}={}){var se=this;return D(function*(){u.isType({url:ae},'string'),u.isType({cacheName:te},'string'),'undefined'==typeof ne&&(ne=Date.now());const ie=yield se.getDB({cacheName:te}),ce=ie.transaction(te,'readwrite');ce.objectStore(te).put({[V]:ne,[$]:ae}),yield ce.complete})()}expireEntries({cacheName:te,now:ae}={}){var ne=this;return D(function*(){u.isType({cacheName:te},'string'),'undefined'==typeof ae&&(ae=Date.now());const se=ne.maxAgeSeconds?yield ne.findOldEntries({cacheName:te,now:ae}):[],ie=ne.maxEntries?yield ne.findExtraEntries({cacheName:te}):[],ce=[...new Set(se.concat(ie))];return yield ne.deleteFromCacheAndIDB({cacheName:te,urls:ce}),ce})()}findOldEntries({cacheName:te,now:ae}={}){var ne=this;return D(function*(){u.isType({cacheName:te},'string'),u.isType({now:ae},'number');const se=ae-1e3*ne.maxAgeSeconds,ie=[],ce=yield ne.getDB({cacheName:te}),oe=ce.transaction(te,'readonly'),de=oe.objectStore(te),le=de.index(V);return le.iterateCursor(function(pe){pe&&(pe.value[V]<se&&ie.push(pe.value[$]),pe.continue())}),yield oe.complete,ie})()}findExtraEntries({cacheName:te}={}){var ae=this;return D(function*(){u.isType({cacheName:te},'string');const ne=[],se=yield ae.getDB({cacheName:te});let ie=se.transaction(te,'readonly'),ce=ie.objectStore(te),oe=ce.index(V);const de=yield oe.count();return de>ae.maxEntries&&(ie=se.transaction(te,'readonly'),ce=ie.objectStore(te),oe=ce.index(V),oe.iterateCursor(function(le){le&&(ne.push(le.value[$]),de-ne.length>ae.maxEntries&&le.continue())})),yield ie.complete,ne})()}deleteFromCacheAndIDB({cacheName:te,urls:ae}={}){var ne=this;return D(function*(){if(u.isType({cacheName:te},'string'),u.isArrayOfType({urls:ae},'string'),0<ae.length){const se=yield ne.getCache({cacheName:te}),ie=yield ne.getDB({cacheName:te});yield ae.forEach((()=>{var ce=D(function*(oe){yield se.delete(oe);const de=ie.transaction(te,'readwrite'),le=de.objectStore(te);yield le.delete(oe),yield de.complete});return function(){return ce.apply(this,arguments)}})())}})()}}const X={'channel-name-required':`The channelName parameter is required when
    constructing a new Plugin`,'responses-are-same-parameters-required':`The first, second, and
    headersToCheck parameters must be valid when calling responsesAreSame()`};var z=new ErrorFactory$1(X);const Z='CACHE_UPDATED',J=['content-length','etag','last-modified'];class Plugin$1{constructor({channelName:te,headersToCheck:ae,source:ne}={}){if('string'!=typeof te||0===te.length)throw z.createError('channel-name-required');this.channelName=te,this.headersToCheck=ae||J,this.source=ne||'sw-broadcast-cache-update'}get channel(){return this._channel||(this._channel=new BroadcastChannel(this.channelName)),this._channel}cacheDidUpdate({cacheName:te,oldResponse:ae,newResponse:ne}){u.isType({cacheName:te},'string'),u.isInstance({newResponse:ne},Response),ae&&this.notifyIfUpdated({cacheName:te,first:ae,second:ne})}notifyIfUpdated({first:te,second:ae,cacheName:ne}){u.isType({cacheName:ne},'string'),responsesAreSame({first:te,second:ae,headersToCheck:this.headersToCheck})||broadcastUpdate({cacheName:ne,url:ae.url,channel:this.channel,source:this.source})}}class Plugin$2{constructor({statuses:te,headers:ae}={}){u.atLeastOne({statuses:te,headers:ae}),te!==void 0&&u.isArrayOfType({statuses:te},'number'),ae!==void 0&&u.isType({headers:ae},'object'),this.statuses=te,this.headers=ae}cacheWillUpdate({response:te}={}){return this.isResponseCacheable({response:te})}isResponseCacheable({response:te}={}){u.isInstance({response:te},Response);let ae=!0;return this.statuses&&(ae=this.statuses.includes(te.status)),this.headers&&ae&&(ae=Object.keys(this.headers).some((ne)=>{return te.headers.get(ne)===this.headers[ne]})),ae}}class SWLib{constructor(){this._router=new Router$$1,this._revisionedCacheManager=new RevisionedCacheManager,this._unrevisionedCacheManager=new UnrevisionedCacheManager,this._registerInstallActivateEvents(),this._registerDefaultRoutes()}cacheRevisionedAssets(te){if(!Array.isArray(te))throw r.createError('bad-revisioned-cache-list');this._revisionedCacheManager.addToCacheList({revisionedFiles:te})}warmRuntimeCache(te){if(!Array.isArray(te))throw r.createError('bad-revisioned-cache-list');this._unrevisionedCacheManager.addToCacheList({unrevisionedFiles:te})}get router(){return this._router}get Route(){return Route}cacheFirst(te){return this._getCachingMechanism(CacheFirst,te)}cacheOnly(te){return this._getCachingMechanism(CacheOnly,te)}networkFirst(te){return this._getCachingMechanism(NetworkFirst,te)}networkOnly(te){return this._getCachingMechanism(NetworkOnly,te)}staleWhileRevalidate(te){return this._getCachingMechanism(StaleWhileRevalidate,te)}_getCachingMechanism(te,ae={}){const ne={cacheExpiration:Plugin,broadcastCacheUpdate:Plugin$1,cacheableResponse:Plugin$2},se={plugins:[]};ae.cacheName&&(se.cacheName=ae.cacheName);const ie=Object.keys(ne);return ie.forEach((ce)=>{if(ae[ce]){const oe=ne[ce],de=ae[ce];se.plugins.push(new oe(de))}}),ae.plugins&&ae.plugins.forEach((ce)=>{se.plugins.push(ce)}),new te({requestWrapper:new RequestWrapper(se)})}_registerInstallActivateEvents(){self.addEventListener('install',(te)=>{te.waitUntil(Promise.all([this._revisionedCacheManager.install(),this._unrevisionedCacheManager.install()]))}),self.addEventListener('activate',(te)=>{te.waitUntil(Promise.all([this._revisionedCacheManager.cleanup(),this._unrevisionedCacheManager.cleanup()]))})}_registerDefaultRoutes(){const te=this.cacheFirst({cacheName:this._revisionedCacheManager.getCacheName()}),ae=new this.Route({match:({url:ne,event:se})=>{const ie=this._revisionedCacheManager.getCachedUrls();return-1!==ie.indexOf(ne.href)},handler:te});this.router.registerRoute(ae)}}if(!u.isSWEnv())throw r.createError('not-in-sw');const ee=new SWLib;return ee});
